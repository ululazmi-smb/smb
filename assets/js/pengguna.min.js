var id_user = "";
let url, pelanggan = $("#pengguna").DataTable({
    responsive: true,
    scrollX: true,
    ajax: readUrl,
    columnDefs: [{
        searcable: false,
        orderable: false,
        targets: 0
    }],
    order: [
        [1, "asc"]
    ],
    columns: [{
        data: null
    }, {
        data: "username"
    }, {
        data: "nama"
    }, {
        data: "level"
    }, {
        data: "foto"
    }, {
        data: "action"
    }]
});

function edit(id)
{
    id_user = id;
}

function save()
{
    var email = $("#email").val();
    var username = $("#username").val();
    var password = $("#password").val();
    $.ajax({
        url: editUrl,
        type: "POST",
        dataType: "json",
        data: {
            id : id_user,
            email : email,
            username : username,
            password : password
        },
        success: res => {
            id_user = "";
            if(res.error == "success")
            {
                $("#email").val("");
                $("#username").val("");
                $("#password").val("");
                Swal.fire("Sukses", "Sukses Mengedit data", "success");
                $(".modal").modal("hide");
                reloadTable()
            } else {
                Swal.fire("Galat", res.messages, "error");
            }
        },
        error: err => {
            id_user = "";
            console.log(err)
        }
    })
}

function reloadTable() {
    pelanggan.ajax.reload()
}
pelanggan.on("order.dt search.dt", () => {
    pelanggan.column(0, {
        search: "applied",
        order: "applied"
    }).nodes().each((el, val) => {
        el.innerHTML = val + 1
    })
});

